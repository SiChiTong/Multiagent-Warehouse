package warehouse.agents;

import java.util.Iterator;
import java.util.List;
import java.util.function.Consumer;

import org.json.JSONObject;

import jade.core.AID;
import jade.core.Agent;
import jade.core.behaviours.CyclicBehaviour;
import jade.lang.acl.ACLMessage;
import jade.lang.acl.MessageTemplate;

/**
 * @author Patrick Robinson
 *
 */
public class WarehouseAgent extends Agent {
	private class OrderRequestReceiver extends CyclicBehaviour {
		@Override
		public void action() {
			ACLMessage recMsg = receive(MessageTemplate.MatchPerformative(ACLMessage.REQUEST));
			if(recMsg != null) {
				JSONObject json = new JSONObject(recMsg.getContent());
				// Confirm Order
				ACLMessage response = new ACLMessage(ACLMessage.CONFIRM);
				Iterator<AID> replyTo = recMsg.getAllReplyTo();
				while(replyTo.hasNext()) {
					response.addReceiver(replyTo.next());
				}
				response.setLanguage("JSON");
				response.setContent("{id:" + json.getInt("id") + "}");
				send(response);
				// Process Order
			}
		}
	}
	
	private class Order {
		public AID handlingAgentAddress;
		public int id;
		public List<Pair<String, Integer>> items = new ArrayList<>();
	}
	
	private 
	
	protected void setup() {
		this.addBehaviour(new OrderRequestReceiver());
	}
}
